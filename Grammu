--// COCO HUB - DELTA MM2 (NO LOADSTRING, NO HTTPGET, FULL OFFLINE)
local Plr = game.Players.LocalPlayer
local Mouse = Plr:GetMouse()
local Camera = workspace.CurrentCamera
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")

local GUI = Instance.new("ScreenGui", Plr:WaitForChild("PlayerGui"))
GUI.Name = "COCO_HUB"
local Frame = Instance.new("Frame", GUI)
Frame.Size = UDim2.new(0, 300, 0, 400)
Frame.Position = UDim2.new(0.5, -150, 0.5, -200)
Frame.BackgroundColor3 = Color3.new(0, 0, 0)
Frame.BackgroundTransparency = 0.3
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true

local function createButton(text, y, callback)
	local btn = Instance.new("TextButton", Frame)
	btn.Size = UDim2.new(1, -10, 0, 30)
	btn.Position = UDim2.new(0, 5, 0, y)
	btn.Text = text
	btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.TextScaled = true
	btn.MouseButton1Click:Connect(callback)
	return btn
end

-- Variables
local walkSpeed = 16
local jumpPower = 50
local aimbotEnabled = false
local silentAimEnabled = false
local espEnabled = false
local lockPart = "Head" -- or "HumanoidRootPart"
local teamTags = true

-- MM2 Team Tag System
local function applyTeamTags()
	for _, player in ipairs(game.Players:GetPlayers()) do
		if player ~= Plr then
			local tag = player:FindFirstChild("Role") or player:FindFirstChild("role") or player:FindFirstChild("leaderstats") and player.leaderstats:FindFirstChild("Team")
			if tag then
				local color = Color3.new(1,1,1)
				local txt = tostring(tag.Value)
				if txt:lower() == "innocent" then color = Color3.fromRGB(0,255,0)
				elseif txt:lower() == "sheriff" then color = Color3.fromRGB(0,0,255)
				elseif txt:lower() == "murderer" then color = Color3.fromRGB(255,0,0)
				end
				if not player:FindFirstChild("COCOTag") then
					local bill = Instance.new("BillboardGui", player.Character:WaitForChild("Head"))
					bill.Name = "COCOTag"
					bill.Size = UDim2.new(0,100,0,30)
					bill.StudsOffset = Vector3.new(0,2,0)
					bill.AlwaysOnTop = true
					local txtlbl = Instance.new("TextLabel", bill)
					txtlbl.Size = UDim2.new(1,0,1,0)
					txtlbl.Text = txt
					txtlbl.BackgroundTransparency = 1
					txtlbl.TextColor3 = color
					txtlbl.TextScaled = true
				end
			end
		end
	end
end

-- ESP
local function enableESP()
	while espEnabled do
		for _,v in ipairs(game.Players:GetPlayers()) do
			if v ~= Plr and v.Character and v.Character:FindFirstChild("Head") then
				if not v.Character.Head:FindFirstChild("ESP") then
					local esp = Instance.new("BillboardGui", v.Character.Head)
					esp.Name = "ESP"
					esp.Size = UDim2.new(0, 100, 0, 20)
					esp.AlwaysOnTop = true
					esp.StudsOffset = Vector3.new(0, 2, 0)
					local txt = Instance.new("TextLabel", esp)
					txt.Text = v.Name
					txt.Size = UDim2.new(1,0,1,0)
					txt.BackgroundTransparency = 1
					txt.TextColor3 = Color3.new(1,0,0)
					txt.TextScaled = true
				end
			end
		end
		task.wait(1)
	end
	for _,v in ipairs(game.Players:GetPlayers()) do
		if v.Character and v.Character:FindFirstChild("Head") and v.Character.Head:FindFirstChild("ESP") then
			v.Character.Head.ESP:Destroy()
		end
	end
end

-- Aimbot
local function getClosestTarget()
	local maxDist = 9999
	local target = nil
	for _,v in ipairs(game.Players:GetPlayers()) do
		if v ~= Plr and v.Character and v.Character:FindFirstChild(lockPart) then
			local pos, onScreen = Camera:WorldToViewportPoint(v.Character[lockPart].Position)
			local dist = (Vector2.new(pos.X,pos.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
			if onScreen and dist < maxDist then
				maxDist = dist
				target = v
			end
		end
	end
	return target
end

RS.RenderStepped:Connect(function()
	if aimbotEnabled then
		local target = getClosestTarget()
		if target and target.Character and target.Character:FindFirstChild(lockPart) then
			Camera.CFrame = CFrame.new(Camera.CFrame.Position, target.Character[lockPart].Position)
		end
	end
end)

-- WalkSpeed / Jump
Plr.CharacterAdded:Connect(function(char)
	task.wait(1)
	char:WaitForChild("Humanoid").WalkSpeed = walkSpeed
	char.Humanoid.JumpPower = jumpPower
end)

-- Buttons
local y = 10
createButton("WalkSpeed +20", y, function()
	walkSpeed = math.clamp(walkSpeed + 20, 16, 200)
	if Plr.Character and Plr.Character:FindFirstChild("Humanoid") then
		Plr.Character.Humanoid.WalkSpeed = walkSpeed
	end
end)
y += 35

createButton("High Jump +10", y, function()
	jumpPower += 10
	if Plr.Character and Plr.Character:FindFirstChild("Humanoid") then
		Plr.Character.Humanoid.JumpPower = jumpPower
	end
end)
y += 35

createButton("Toggle Aimbot", y, function()
	aimbotEnabled = not aimbotEnabled
end)
y += 35

createButton("Toggle Silent Aim", y, function()
	silentAimEnabled = not silentAimEnabled
end)
y += 35

createButton("Toggle ESP", y, function()
	espEnabled = not espEnabled
	enableESP()
end)
y += 35

createButton("Lock: Head / Body", y, function()
	lockPart = (lockPart == "Head" and "HumanoidRootPart" or "Head")
end)
y += 35

createButton("Toggle Team Tags", y, function()
	teamTags = not teamTags
	if teamTags then
		applyTeamTags()
	else
		for _,p in ipairs(game.Players:GetPlayers()) do
			if p.Character and p.Character:FindFirstChild("Head") then
				local t = p.Character.Head:FindFirstChild("COCOTag")
				if t then t:Destroy() end
			end
		end
	end
end)
