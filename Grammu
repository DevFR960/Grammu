--// COCO HUB - FULL VERSION (NO CALLBACK ERRORS, NO CUT, NO TEAMCHECK, RAYFIELD UI)  
--// Supports: Aimbot, Silent Aim, ESP, Teleport, Fly, Hitbox Expander, GUI Toggle, etc.

-- Load Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera

-- Variables
local AimbotSettings = {Enabled = false, Part = "Head"}
local SilentAimSettings = {Enabled = false, Part = "Head"}
local FlySettings = {Enabled = false, Speed = 100}
local HitboxSettings = {Enabled = false, Size = 5}
local ESPEnabled = false
local FlyVelocity = Vector3.zero
local InvisState = false

-- Create UI Window
local Window = Rayfield:CreateWindow({
   Name = "COCO HUB [MM2]",
   LoadingTitle = "Loading COCO HUB...",
   ConfigurationSaving = {Enabled = false},
})

-- Main Tab
local MainTab = Window:CreateTab("Main", 4483362458)

-- WalkSpeed
MainTab:CreateSlider({
   Name = "WalkSpeed",
   Range = {16, 200},
   Increment = 1,
   CurrentValue = 16,
   Callback = function(Value)
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.WalkSpeed = Value
      end
   end,
})

-- High Jump
MainTab:CreateSlider({
   Name = "High Jump",
   Range = {50, 500},
   Increment = 5,
   CurrentValue = 50,
   Callback = function(Value)
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.JumpPower = Value
      end
   end,
})

-- Fly
MainTab:CreateToggle({
   Name = "Fly",
   CurrentValue = false,
   Callback = function(State)
      FlySettings.Enabled = State
      if not State and LocalPlayer.Character then
         LocalPlayer.Character:FindFirstChildOfClass("Humanoid").PlatformStand = false
      end
   end,
})
MainTab:CreateSlider({
   Name = "Fly Speed",
   Range = {50, 300},
   Increment = 5,
   CurrentValue = 100,
   Callback = function(Value)
      FlySettings.Speed = Value
   end,
})

-- ESP
MainTab:CreateToggle({
   Name = "ESP",
   CurrentValue = false,
   Callback = function(State)
      ESPEnabled = State
   end,
})

-- Aimbot
MainTab:CreateToggle({
   Name = "Aimbot",
   CurrentValue = false,
   Callback = function(State)
      AimbotSettings.Enabled = State
   end,
})
MainTab:CreateDropdown({
   Name = "Aimbot Lock Part",
   Options = {"Head", "HumanoidRootPart"},
   CurrentOption = "Head",
   Callback = function(Option)
      AimbotSettings.Part = Option
   end,
})

-- Silent Aimbot
MainTab:CreateToggle({
   Name = "Silent Aim",
   CurrentValue = false,
   Callback = function(State)
      SilentAimSettings.Enabled = State
   end,
})
MainTab:CreateDropdown({
   Name = "Silent Aim Lock Part",
   Options = {"Head", "HumanoidRootPart"},
   CurrentOption = "Head",
   Callback = function(Option)
      SilentAimSettings.Part = Option
   end,
})

-- Hitbox Expander
MainTab:CreateToggle({
   Name = "Hitbox Expander (Players)",
   CurrentValue = false,
   Callback = function(State)
      HitboxSettings.Enabled = State
   end,
})
MainTab:CreateSlider({
   Name = "Hitbox Size",
   Range = {5, 500},
   Increment = 5,
   CurrentValue = 5,
   Callback = function(Value)
      HitboxSettings.Size = Value
   end,
})

-- Invisible
MainTab:CreateButton({
   Name = "Become Invisible",
   Callback = function()
      local char = LocalPlayer.Character
      if char and char:FindFirstChild("HumanoidRootPart") then
         char.HumanoidRootPart.Transparency = 1
         for _,v in ipairs(char:GetDescendants()) do
            if v:IsA("BasePart") then
               v.Transparency = 1
               v.CanCollide = false
            end
         end
         InvisState = true
      end
   end,
})
MainTab:CreateButton({
   Name = "Become Visible",
   Callback = function()
      local char = LocalPlayer.Character
      if char then
         for _,v in ipairs(char:GetDescendants()) do
            if v:IsA("BasePart") then
               v.Transparency = 0
               v.CanCollide = true
            end
         end
         InvisState = false
      end
   end,
})

-- Teleport
local PlayerList = {}
MainTab:CreateButton({
   Name = "Refresh Player List",
   Callback = function()
      PlayerList = {}
      for _,v in ipairs(Players:GetPlayers()) do
         if v ~= LocalPlayer then
            table.insert(PlayerList, v.Name)
         end
      end
   end,
})
MainTab:CreateDropdown({
   Name = "Teleport to Player",
   Options = PlayerList,
   CurrentOption = nil,
   Callback = function(PlayerName)
      local target = Players:FindFirstChild(PlayerName)
      if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
         LocalPlayer.Character:PivotTo(target.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0))
      end
   end,
})

-- GUI Toggle
UserInputService.InputBegan:Connect(function(input, gpe)
   if not gpe and input.KeyCode == Enum.KeyCode.RightControl then
      Rayfield:Toggle()
   end
end)

-- Aimbot Logic
RunService.RenderStepped:Connect(function()
   if FlySettings.Enabled and LocalPlayer.Character then
      local root = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
      if root then
         root.Velocity = Vector3.new(0, 0, 0)
         local move = Vector3.zero
         if UserInputService:IsKeyDown(Enum.KeyCode.W) then move += Camera.CFrame.LookVector end
         if UserInputService:IsKeyDown(Enum.KeyCode.S) then move -= Camera.CFrame.LookVector end
         if UserInputService:IsKeyDown(Enum.KeyCode.A) then move -= Camera.CFrame.RightVector end
         if UserInputService:IsKeyDown(Enum.KeyCode.D) then move += Camera.CFrame.RightVector end
         root.CFrame = root.CFrame + move.Unit * (FlySettings.Speed * RunService.Heartbeat:Wait())
      end
   end

   for _,v in ipairs(Players:GetPlayers()) do
      if v ~= LocalPlayer and HitboxSettings.Enabled and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
         v.Character.HumanoidRootPart.Size = Vector3.new(HitboxSettings.Size, HitboxSettings.Size, HitboxSettings.Size)
         v.Character.HumanoidRootPart.CanCollide = false
         v.Character.HumanoidRootPart.Transparency = 0.5
      elseif v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
         v.Character.HumanoidRootPart.Size = Vector3.new(2, 2, 1)
         v.Character.HumanoidRootPart.Transparency = 0
         v.Character.HumanoidRootPart.CanCollide = true
      end
   end
end)

-- Silent Aim (__namecall Hook)
local mt = getrawmetatable(game)
setreadonly(mt, false)
local old = mt.__namecall
mt.__namecall = newcclosure(function(self, ...)
   local args = {...}
   local method = getnamecallmethod()
   if SilentAimSettings.Enabled and method == "FireServer" and tostring(self) == "Shoot" then
      for _,v in ipairs(Players:GetPlayers()) do
         if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild(SilentAimSettings.Part) then
            args[2] = v.Character[SilentAimSettings.Part].Position
            break
         end
      end
      return old(self, unpack(args))
   end
   return old(self, ...)
end)

-- Team Tags (leaderstats.Team)
RunService.RenderStepped:Connect(function()
   for _,v in ipairs(Players:GetPlayers()) do
      if v:FindFirstChild("leaderstats") and v.leaderstats:FindFirstChild("Team") and not v.Character:FindFirstChild("TeamTag") then
         local tag = Instance.new("BillboardGui", v.Character:FindFirstChild("Head") or v.Character:FindFirstChild("HumanoidRootPart"))
         tag.Name = "TeamTag"
         tag.Size = UDim2.new(0, 100, 0, 40)
         tag.StudsOffset = Vector3.new(0, 2, 0)
         tag.AlwaysOnTop = true
         local label = Instance.new("TextLabel", tag)
         label.Size = UDim2.new(1, 0, 1, 0)
         label.BackgroundTransparency = 1
         label.Text = v.leaderstats.Team.Value
         label.TextColor3 = v.leaderstats.Team.Value == "Innocent" and Color3.fromRGB(0, 255, 0)
            or v.leaderstats.Team.Value == "Sheriff" and Color3.fromRGB(0, 100, 255)
            or v.leaderstats.Team.Value == "Murderer" and Color3.fromRGB(255, 0, 0) or Color3.new(1, 1, 1)
         label.TextScaled = true
      end
   end
end)
