--// COCO HUB - FULL FEATURED SCRIPT (Converted to Rayfield UI with Silent Aimbot Auto Shoot and KeySystem)

-- โหลด Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "COCO HUB",
    LoadingTitle = "COCO HUB",
    LoadingSubtitle = "by Developer",
    ConfigurationSaving = {
        Enabled = false
    },
    Discord = {
        Enabled = false
    },
    KeySystem = true, -- เปิดระบบ KeySystem
    KeySettings = {
        Title = "COCO HUB KEY",
        Subtitle = "ใส่รหัสก่อนใช้งาน",
        Note = "POSS NGO",
        FileName = "COCOHUBKEY",
        SaveKey = false,
        GrabKeyFromSite = false,
        Key = "Flower" -- รหัสคีย์ที่ต้องใช้
    }
})

local Plr = game.Players.LocalPlayer
local camera = workspace.CurrentCamera
local isMobile = game:GetService("UserInputService").TouchEnabled

local PlayerTP = nil
local drop = nil
local highJump = false
local fov = 100
local fovCircle = nil
local aimbotEnabled = false
local hitboxEnabled = false
local hitboxSize = 5
local silentAimbotEnabled = false
local silentAimbotFOV = 100
local silentFOVCircle = nil
local silentTarget = nil

--====================================================================
-- TAB: Player
--====================================================================
local TabPlayer = Window:CreateTab("Player", 4483362458)
TabPlayer:CreateSection("Section Player!")

local function refreshPlayers()
    local list = {}
    for _, v in pairs(game.Players:GetPlayers()) do
        table.insert(list, v.Name)
    end
    return list
end

drop = TabPlayer:CreateDropdown({
    Name = "Select Player!",
    Options = refreshPlayers(),
    CurrentOption = "",
    Callback = function(t)
        PlayerTP = t
    end
})

-- แก้ไขระบบ TP ให้เช็คตัวละครและ HumanoidRootPart ก่อนวาป และพยายาม retry ถ้ายังไม่เจอ
TabPlayer:CreateButton({
    Name = "Click To TP",
    Callback = function()
        local target = game.Players:FindFirstChild(PlayerTP)
        if not target then
            warn("Target player not found")
            return
        end
        local function tryTP()
            local plrChar = Plr.Character
            local targetChar = target.Character
            if plrChar and targetChar then
                local hrp = plrChar:FindFirstChild("HumanoidRootPart")
                local targetHrp = targetChar:FindFirstChild("HumanoidRootPart")
                if hrp and targetHrp then
                    hrp.CFrame = targetHrp.CFrame
                    return true
                end
            end
            return false
        end
        local tries = 0
        while tries < 10 do
            if tryTP() then
                break
            end
            tries = tries + 1
            task.wait(0.1)
        end
    end
})

TabPlayer:CreateButton({
    Name = "Refresh Dropdown",
    Callback = function()
        drop:SetOptions(refreshPlayers())
    end
})

-- ระบบ ESP
TabPlayer:CreateToggle({
    Name = "ESP",
    CurrentValue = false,
    Callback = function(state)
        _G.ESP = state
        local localName = Plr.Name
        if state then
            task.spawn(function()
                while _G.ESP do
                    task.wait(0.1)
                    for _, v in pairs(game.Players:GetPlayers()) do
                        if v.Name ~= localName and v.Character then
                            if not v.Character:FindFirstChild("ESP") then
                                local hl = Instance.new("Highlight")
                                hl.Name = "ESP"
                                hl.FillColor = Color3.new(0,1,0.08)
                                hl.OutlineColor = Color3.new(0.9,1,0)
                                hl.FillTransparency = 0.5
                                hl.Adornee = v.Character
                                hl.Parent = v.Character
                            end
                        end
                    end
                end
            end)
        else
            -- ปิด ESP ลบ Highlight ทุกตัว
            for _, v in pairs(game.Players:GetPlayers()) do
                if v.Character then
                    local hl = v.Character:FindFirstChild("ESP")
                    if hl then
                        hl:Destroy()
                    end
                end
            end
        end
    end
})

-- High Jump toggle พร้อมระบบรีเซ็ต JumpPower เวลาตัวละคร Respawn
local function setJumpPower(value)
    local humanoid = Plr.Character and Plr.Character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.JumpPower = value
    end
end

local function onCharacterAdded(char)
    if highJump then
        setJumpPower(100)
    else
        setJumpPower(50)
    end
end

Plr.CharacterAdded:Connect(onCharacterAdded)

TabPlayer:CreateToggle({
    Name = "High Jump",
    CurrentValue = false,
    Callback = function(state)
        highJump = state
        if highJump then
            setJumpPower(100)
        else
            setJumpPower(50)
        end
    end
})

-- Speed slider
TabPlayer:CreateSlider({
    Name = "Speed",
    Range = {16, 100},
    Increment = 1,
    CurrentValue = 16,
    Callback = function(value)
        local humanoid = Plr.Character and Plr.Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = value
        end
    end
})

-- FOV Aimbot with Rainbow Circle
TabPlayer:CreateToggle({
    Name = "FOV Aimbot with Rainbow Circle",
    CurrentValue = false,
    Callback = function(state)
        aimbotEnabled = state
        if state then
            if fovCircle then fovCircle:Remove() end
            fovCircle = Drawing.new("Circle")
            fovCircle.Color = Color3.fromRGB(255,0,0)
            fovCircle.Thickness = 2
            fovCircle.Transparency = 0.5
            fovCircle.Radius = fov
            fovCircle.Filled = false
            fovCircle.Position = Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)
            fovCircle.Visible = true
            task.spawn(function()
                while aimbotEnabled do
                    task.wait(0.1)
                    fovCircle.Color = Color3.fromHSV((tick() % 5) / 5, 1, 1)
                    local closest, dist = nil, math.huge
                    for _, p in pairs(game.Players:GetPlayers()) do
                        if p ~= Plr and p.Character and p.Character:FindFirstChild("Head") then
                            local pos, onScreen = camera:WorldToViewportPoint(p.Character.Head.Position)
                            if onScreen then
                                local d = (Vector2.new(pos.X,pos.Y) - fovCircle.Position).Magnitude
                                if d < fov and d < dist then
                                    closest, dist = p.Character.Head, d
                                end
                            end
                        end
                    end
                    if closest then
                        camera.CFrame = CFrame.new(camera.CFrame.Position, closest.Position)
                    end
                end
                if fovCircle then fovCircle:Remove(); fovCircle = nil end
            end)
        else
            if fovCircle then fovCircle:Remove(); fovCircle = nil end
        end
    end
})

TabPlayer:CreateSlider({
    Name = "Aimbot FOV",
    Range = {100, 500},
    Increment = 10,
    CurrentValue = 100,
    Callback = function(value)
        fov = value
        if fovCircle then fovCircle.Radius = value end
    end
})

-- Hitbox Expander toggle & slider
TabPlayer:CreateToggle({
    Name = "Hitbox Expander (Players)",
    CurrentValue = false,
    Callback = function(state)
        hitboxEnabled = state
    end
})

TabPlayer:CreateSlider({
    Name = "Hitbox Size",
    Range = {5, 500},
    Increment = 5,
    CurrentValue = 5,
    Callback = function(value)
        hitboxSize = value
    end
})

-- Hitbox Expander loop (แก้ให้เช็ค HumanoidRootPart ก่อนเปลี่ยน และรีเซ็ตให้ถูกต้อง)
spawn(function()
    while true do
        task.wait(0.1)
        for _, player in ipairs(game.Players:GetPlayers()) do
            if player ~= Plr and player.Character then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    if hitboxEnabled then
                        hrp.Size = Vector3.new(hitboxSize, hitboxSize, hitboxSize)
                        hrp.Transparency = 0.7
                        hrp.Material = Enum.Material.Neon
                        hrp.Color = Color3.fromRGB(255, 0, 0)
                        hrp.CanCollide = false
                    else
                        hrp.Size = Vector3.new(2, 2, 1)
                        hrp.Transparency = 1
                        hrp.Material = Enum.Material.Plastic
                        hrp.Color = Color3.fromRGB(255, 255, 255)
                        hrp.CanCollide = true
                    end
                end
            end
        end
    end
end)

--====================================================================
-- TAB: Silent Aimbot
--====================================================================
local TabSA = Window:CreateTab("Silent Aimbot", 4483362458)
TabSA:CreateSection("Silent Aimbot Settings")

TabSA:CreateToggle({
    Name = "Enable Silent Aimbot",
    CurrentValue = false,
    Callback = function(state)
        silentAimbotEnabled = state
        if state then
            if silentFOVCircle then silentFOVCircle:Remove() end
            silentFOVCircle = Drawing.new("Circle")
            silentFOVCircle.Color = Color3.fromRGB(0,255,255)
            silentFOVCircle.Thickness = 2
            silentFOVCircle.Transparency = 0.5
            silentFOVCircle.Radius = silentAimbotFOV
            silentFOVCircle.Filled = false
            silentFOVCircle.Position = Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)
            silentFOVCircle.Visible = true
            task.spawn(function()
                while silentAimbotEnabled do
                    task.wait(0.1)
                    silentFOVCircle.Color = Color3.fromHSV((tick() % 5) / 5, 1, 1)
                    local closest, dist = nil, math.huge
                    for _, p in pairs(game.Players:GetPlayers()) do
                        if p ~= Plr and p.Character and p.Character:FindFirstChild("Head") then
                            local pos, onScreen = camera:WorldToViewportPoint(p.Character.Head.Position)
                            if onScreen then
                                local d = (Vector2.new(pos.X,pos.Y) - Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)).Magnitude
                                if d < silentAimbotFOV and d < dist then
                                    closest = p.Character.Head
                                    dist = d
                                end
                            end
                        end
                    end
                    silentTarget = closest
                end
                silentTarget = nil
                if silentFOVCircle then silentFOVCircle:Remove(); silentFOVCircle = nil end
            end)
        else
            if silentFOVCircle then silentFOVCircle:Remove(); silentFOVCircle = nil end
        end
    end
})

TabSA:CreateSlider({
    Name = "Silent Aimbot FOV",
    Range = {100, 500},
    Increment = 10,
    CurrentValue = 100,
    Callback = function(value)
        silentAimbotFOV = value
        if silentFOVCircle then silentFOVCircle.Radius = value end
    end
})

-- ⭐ เพิ่มระบบ Auto Shoot Silent Aimbot ⭐
task.spawn(function()
    while true do
        task.wait(0.05)
        if silentAimbotEnabled and silentTarget then
            local tool = Plr.Character and Plr.Character:FindFirstChildOfClass("Tool")
            if tool then
                local remote = tool:FindFirstChildWhichIsA("RemoteEvent")
                if remote then
                    pcall(function()
                        remote:FireServer(silentTarget.Position)
                    end)
                    task.wait(0.2)
                end
            end
        end
    end
end)
